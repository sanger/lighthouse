db.samples.aggregate([
  {"$match":
    {"plate_barcode":
      {"$in":
        ["cpRNA101297","cpRNA101298","cpRNA101299","cpRNA101300","cpRNA101301","cpRNA101302","cpRNA101303","cpRNA101304","cpRNA101305","cpRNA101306","cpRNA101307","cpRNA101308","cpRNA101309","cpRNA101310","cpRNA101311","cpRNA101312","cpRNA101313","cpRNA101314","cpRNA101315","cpRNA101316","cpRNA101317","cpRNA101318","cpRNA101319","cpRNA101320","cpRNA101321","cpRNA101323","cpRNA101324","cpRNA101325","cpRNA101326","cpRNA101327","cpRNA101328","cpRNA101329","cpRNA101330","cpRNA101331","cpRNA101332","cpRNA101333","cpRNA101334","cpRNA101335","cpRNA101336","cpRNA101337","cpRNA101338","cpRNA101339","cpRNA101340","cpRNA101341","cpRNA101342","cpRNA101343","cpRNA101344","cpRNA101345","cpRNA101346","cpRNA101347","cpRNA101348","cpRNA101349","cpRNA101350","cpRNA101351","cpRNA101352","cpRNA101353","cpRNA101354"]
      }
    }
  },

  {
    "$lookup": {
      "from": "priority_samples",
      "pipeline": [
        {
          "$match": {
            "$expr": {
              "$and": [
                {"$eq": ["$$sample_id", "$$_id"]},
                {"$eq": ["processed", 1]},
              ]
            }
          },
        },
        {
          "$project": {
            "processed": 1,
            "must_sequence": 1,
            "preferentially_sequence": 1,
          },
        },
      ],
      "as": "from_priority_samples",
    }
  }
])